<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>âœ¨ å—å´ä¸€å°æ™‚ç†±é–€æ™¯é»æŠ½ç±¤è¼ªç›¤ (å³åœ–é¢¨æ ¼å„ªåŒ–ç‰ˆ) âœ¨</title>
    <style>
        /* ğŸ¨ å…¨å±€æ¨£å¼èˆ‡è¨­è¨ˆ */
        body {
            font-family: 'å¾®è»Ÿæ­£é»‘é«”', 'Microsoft JhengHei', Arial, sans-serif;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            min-height: 100vh;
            margin: 0;
            background: linear-gradient(135deg, #e3f2fd 0%, #bbdefb 100%); /* èˆ’é©æ¸…æ–°çš„è—è‰²æ¼¸è®ŠèƒŒæ™¯ */
            color: #3f51b5; /* æ·±è—è‰²æ–‡å­— */
            padding: 20px;
        }

        h1 {
            color: #1a237e; /* æ›´æ·±çš„è—è‰²æ¨™é¡Œ */
            margin-bottom: 30px;
            font-size: 2.2em;
            letter-spacing: 1.5px;
            text-shadow: 1px 1px 3px rgba(0, 0, 0, 0.2);
            padding-bottom: 10px;
            border-bottom: 3px solid #64b5f6;
            text-align: center;
        }

        /* è¼ªç›¤å®¹å™¨ */
        .wheel-container {
            position: relative;
            width: 420px; /* èª¿æ•´å°ºå¯¸è®“å®ƒçœ‹èµ·ä¾†æ›´åƒç¯„ä¾‹ */
            height: 420px;
            margin: 30px auto;
        }

        /* è½‰ç›¤æœ¬é«” */
        #wheel {
            position: relative;
            width: 100%;
            height: 100%;
            border-radius: 50%;
            overflow: hidden; /* ç¢ºä¿æ‰‡å½¢è£å‰ªæ­£ç¢º */
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.2), inset 0 0 8px rgba(255, 255, 255, 0.6);
            transition: transform 6s cubic-bezier(0.25, 0.1, 0.25, 1); /* æ›´æµæš¢çš„åŠ é€Ÿ-æ¸›é€Ÿæ›²ç·š */
            border: 8px solid #ffffff; /* ç™½è‰²é‚Šæ¡† */
            box-sizing: border-box;
            background-color: #f8f8f8; /* èƒŒæ™¯è‰²ä»¥é˜²è¬ä¸€ */
        }

        /* è¼ªç›¤æŒ‡é‡ */
        .pointer {
            position: absolute;
            top: -25px; /* ä½æ–¼è½‰ç›¤ä¸Šæ–¹ */
            left: 50%;
            transform: translateX(-50%);
            z-index: 20;
            width: 0;
            height: 0;
            border-left: 18px solid transparent;
            border-right: 18px solid transparent;
            border-top: 35px solid #ef5350; /* é®®ç´…è‰²æŒ‡é‡ */
            filter: drop-shadow(0 4px 6px rgba(0, 0, 0, 0.3));
        }

        /* è½‰ç›¤ä¸­å¤®è¦†è“‹å±¤ (å–ä»£åŸå§‹ä¸­é–“çš„æ–‡å­—ï¼Œæ›´è²¼è¿‘å³åœ–) */
        .wheel-center-overlay {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: rgba(0, 0, 0, 0.7); /* æ·±è‰²èƒŒæ™¯ */
            color: #fff;
            padding: 15px 30px;
            border-radius: 40px;
            z-index: 15; /* ç¢ºä¿åœ¨æ‰‡å½¢ä¹‹ä¸Š */
            font-size: 1.1em;
            font-weight: bold;
            letter-spacing: 1px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.3);
            white-space: nowrap; /* é˜²æ­¢æ–‡å­—æ›è¡Œ */
        }

        /* æ‰‡å½¢åŸºç¤æ¨£å¼ */
        .wheel-slice {
            position: absolute;
            top: 0;
            left: 0;
            width: 50%;
            height: 50%;
            transform-origin: 100% 100%; /* æ—‹è½‰ä¸­å¿ƒåœ¨å³ä¸‹è§’ */
            overflow: hidden;
            box-sizing: border-box;
            border-right: 1px solid rgba(255, 255, 255, 0.4); /* åˆ†éš”ç·š */
            border-top: 1px solid rgba(255, 255, 255, 0.4); /* åˆ†éš”ç·š */
        }

        /* æ‰‡å½¢å…§å®¹ (æ–‡å­—) */
        .slice-content {
            position: absolute;
            width: 200%; /* å¯¬åº¦è¶³å¤ è¦†è“‹æ•´å€‹æ‰‡å€ */
            height: 200%; /* é«˜åº¦è¶³å¤ è¦†è“‹æ•´å€‹æ‰‡å€ */
            transform: 
                rotate(var(--text-rotation)) 
                translate(15%, 25%) 
                scale(0.8); /* èª¿æ•´ä½ç½®å’Œç¸®æ”¾ */
            transform-origin: 0% 0%; /* æ–‡å­—æ—‹è½‰çš„åŸºæº–é» */
            font-size: 0.9em; /* é©ç•¶å¤§å° */
            font-weight: 600;
            color: #fff; /* ç™½è‰²æ–‡å­— */
            text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.5); /* é™°å½±è®“æ–‡å­—æ›´çªå‡º */
            text-align: left; /* æ–‡å­—é å·¦ */
            padding-left: 10px; /* å…§éƒ¨é–“è· */
            box-sizing: border-box;
            display: flex;
            align-items: center;
        }

        /* é¡è‰²ä¸»é¡Œ - æ¡ç”¨é®®æ˜ä¸”äº’ç›¸æ­é…çš„è‰²å½©ï¼Œé¿å…é£½å’Œåº¦éé«˜æˆ–éä½ */
        .color-0 { background-color: #66bb6a; } /* æ·ºç¶  */
        .color-1 { background-color: #42a5f5; } /* äº®è— */
        .color-2 { background-color: #ffa726; } /* æ©˜é»ƒ */
        .color-3 { background-color: #ec407a; } /* äº®ç²‰ç´… */
        .color-4 { background-color: #9ccc65; } /* æ·ºè‰ç¶  */
        .color-5 { background-color: #26c6da; } /* å¤©è— */
        .color-6 { background-color: #ab47bc; } /* æ·ºç´« */
        .color-7 { background-color: #78909c; } /* ç°è— */
        /* å¦‚æœæœ‰æ›´å¤šé¸é …ï¼Œæœƒå¾ªç’°ä½¿ç”¨é€™äº›é¡è‰² */

        /* æŒ‰éˆ•å€å¡Š */
        .controls {
            display: flex;
            gap: 25px;
            margin-top: 40px;
        }

        /* æŒ‰éˆ•æ¨£å¼ */
        .btn {
            padding: 15px 35px;
            font-size: 1.2em;
            cursor: pointer;
            border: none;
            border-radius: 35px; /* æ›´åœ“æ½¤ */
            transition: all 0.3s ease;
            font-weight: bold;
            box-shadow: 0 6px 12px rgba(0, 0, 0, 0.2);
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        #spinButton {
            background-color: #4caf50; /* ç¶ è‰² */
            color: white;
        }

        #spinButton:hover:not(:disabled) {
            background-color: #388e3c;
            transform: translateY(-3px);
            box-shadow: 0 8px 16px rgba(0, 0, 0, 0.3);
        }

        #spinButton:disabled {
            background-color: #b0bec5;
            cursor: not-allowed;
            opacity: 0.7;
            box-shadow: none;
        }

        #resetButton {
            background-color: #f44336; /* ç´…è‰² */
            color: white;
        }

        #resetButton:hover {
            background-color: #d32f2f;
            transform: translateY(-3px);
            box-shadow: 0 8px 16px rgba(0, 0, 0, 0.3);
        }

        /* çµæœé¡¯ç¤º */
        #result {
            margin-top: 50px;
            font-size: 1.8em;
            font-weight: 700;
            color: #d32f2f; 
            text-align: center;
            min-height: 60px; 
            padding: 15px 30px;
            background-color: #ffffff;
            border-radius: 15px;
            border: 3px solid #64b5f6; /* èˆ‡æ¨™é¡Œç·šé¡è‰²å‘¼æ‡‰ */
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
            width: 90%;
            max-width: 480px;
        }
    </style>
</head>
<body>

    <h1>âœ¨ å—å´ä¸€å°æ™‚ç†±é–€æ™¯é»æŠ½ç±¤è¼ªç›¤ âœ¨</h1>

    <div class="wheel-container">
        <div class="pointer"></div>
        
        <div id="wheel">
            </div>
        
        <div class="wheel-center-overlay">
            æŒ‰ä¸€ä¸‹ä»¥æ—‹è½‰
        </div>
    </div>

    <div class="controls">
        <button id="spinButton" class="btn">é–‹å§‹æŠ½ç±¤</button>
        <button id="resetButton" class="btn">é‡è¨­</button>
    </div>

    <div id="result">é»æ“Šã€Œé–‹å§‹æŠ½ç±¤ã€ï¼Œæ±ºå®šæ‚¨çš„æ—…ç¨‹ï¼</div>

    <audio id="spinSound" src="./spin.mp3" preload="auto" loop></audio>
    <audio id="winSound" src="./win.mp3" preload="auto"></audio>

    <script>
    // --- æ™¯é»è³‡æ–™ (8 å€‹é¸é …) ---
    const prizes = [
        "å¤§æºªè€è¡—", 
        "Xparkæ°´æ—é¤¨", 
        "å°äººåœ‹æ¨‚åœ’", 
        "ç«¹åœæ¼æ¸¯", 
        "æ±çœ¼å±±æ£®æ—",
        "æ‹‰æ‹‰å±±",
        "å¯Œç”°é¦™è‰è¾²å ´",
        "è¯æ³°åå“åŸ"
    ];

    const wheel = document.getElementById('wheel');
    const spinButton = document.getElementById('spinButton');
    const resultDiv = document.getElementById('result');
    const spinSound = document.getElementById('spinSound');
    const winSound = document.getElementById('winSound');
    
    const numPrizes = prizes.length;
    const anglePerPrize = 360 / numPrizes; // æ¯å€‹æ‰‡å½¢çš„è§’åº¦

    // æ–°å¢è®Šæ•¸ä¾†è¿½è¹¤ç´¯ç©çš„ç¸½æ—‹è½‰åº¦æ•¸
    let currentTotalRotation = 0; 

    /**
     * å‰µå»ºè½‰ç›¤æ‰‡å€ (ä¿æŒä¸è®Š)
     */
    function createWheelSlices() {
        wheel.innerHTML = ''; 
        prizes.forEach((prize, index) => {
            const slice = document.createElement('div');
            slice.classList.add('wheel-slice', `color-${index % 8}`); 
            
            slice.style.transform = `rotate(${index * anglePerPrize}deg)`;
            
            const content = document.createElement('div');
            content.classList.add('slice-content');
            
            const textSpan = document.createElement('span');
            textSpan.textContent = prize;
            content.appendChild(textSpan);

            const textRotation = (anglePerPrize / 2) + 90; 
            content.style.setProperty('--text-rotation', `${textRotation}deg`);
            
            slice.appendChild(content);
            wheel.appendChild(slice);
        });
    }

    /**
     * æ—‹è½‰è½‰ç›¤çš„ä¸»é‚è¼¯
     */
    function spinWheel() {
        spinButton.disabled = true;
        resultDiv.textContent = 'è½‰ç›¤æ—‹è½‰ä¸­...ç¥æ‚¨å¥½é‹ï¼';

        // 1. **é—œéµä¿®æ­£æ­¥é©Ÿï¼šåœ¨æ—‹è½‰å‰å…ˆå°‡éæ¸¡æ•ˆæœç§»é™¤ä¸¦é‡ç½®è§’åº¦ã€‚**
        //    è®“è½‰ç›¤ç¬é–“å›åˆ°ä¸€å€‹ã€Œç›¸å°èµ·é»ã€(ä¾‹å¦‚ 0åº¦)ï¼Œä½†å¯¦éš›ä¸Šæ˜¯å¾ç•¶å‰ç¸½è§’åº¦æ¸›å»æ‰€æœ‰æ•´åœˆã€‚
        wheel.style.transition = 'none';
        
        // ç¢ºä¿è½‰ç›¤è¦–è¦ºä¸Šç¶­æŒåœ¨åŸä½ï¼Œä½†æ•¸æ“šä¸Šè¢«é‡ç½®åˆ° 0-360 åº¦ç¯„åœã€‚
        // currentTotalRotation % 360 æœƒå¾—åˆ° 0-359 çš„å€¼ã€‚
        // æˆ‘å€‘å°‡å…¶è¨­ç‚ºæ–°çš„èµ·é»ï¼Œé€™æ¨£ä¸‹ä¸€æ¬¡æ—‹è½‰å°±æ˜¯å¾é€™å€‹ä½ç½®é–‹å§‹å¢åŠ ã€‚
        currentTotalRotation %= 360; 
        wheel.style.transform = `rotate(${currentTotalRotation}deg)`;

        // æš«åœä¸€å°æ®µæ™‚é–“ (0ms) è®“ç€è¦½å™¨å®Œæˆæ¨£å¼é‡ç½®ï¼Œå†é‡æ–°é–‹å§‹å‹•ç•«
        setTimeout(() => {
            // 2. é‡æ–°å•Ÿç”¨éæ¸¡å‹•ç•«
            wheel.style.transition = 'transform 6s cubic-bezier(0.25, 0.1, 0.25, 1)';


            // éš¨æ©Ÿé¸å–ç²çç´¢å¼• (0 åˆ° numPrizes - 1)
            const winnerIndex = Math.floor(Math.random() * numPrizes);
            const winningPrize = prizes[winnerIndex];

            // 3. è¨ˆç®—ç›®æ¨™æ—‹è½‰è§’åº¦ (ç¸½æ˜¯æ­£å‘æ—‹è½‰)
            
            const spins = 5; // æ¯æ¬¡è‡³å°‘è½‰ 5 åœˆ
            const baseRotation = 360 * spins; 
            const targetAngleForPointer = (winnerIndex * anglePerPrize) + (anglePerPrize / 2);
            
            // è½‰ç›¤éœ€è¦è½‰å‹•çš„è§’åº¦ï¼š (ç¸½åœˆæ•¸è§’åº¦) + (å°‡ç²çæ‰‡å€è½‰åˆ°æŒ‡é‡ä¸‹æ–¹çš„è§’åº¦)
            const rotationNeeded = (360 - targetAngleForPointer);

            // æœ€çµ‚çš„ç›®æ¨™è§’åº¦ = ç•¶å‰ç´¯ç©çš„è§’åº¦ + è‡³å°‘çš„åœˆæ•¸ + (æ‰€éœ€é¡å¤–æ—‹è½‰çš„è§’åº¦)
            const finalTargetRotation = currentTotalRotation + baseRotation + rotationNeeded;

            // åŠ å…¥ä¸€é»é»éš¨æ©Ÿåç§»
            const randomOffset = (Math.random() * (anglePerPrize - 5)) - (anglePerPrize / 2 - 2.5); 
            const actualRotation = finalTargetRotation + randomOffset;
            
            // 4. æ›´æ–°ç´¯ç©çš„è§’åº¦
            currentTotalRotation = actualRotation; 

            // 5. æ’­æ”¾æ—‹è½‰éŸ³æ•ˆ
            spinSound.currentTime = 0; 
            spinSound.play().catch(e => console.error("ç„¡æ³•æ’­æ”¾è½‰ç›¤éŸ³æ•ˆ (spin.mp3)ã€‚", e)); 

            // 6. åŸ·è¡Œæ—‹è½‰
            wheel.style.transform = `rotate(${actualRotation}deg)`;

            // 7. æ—‹è½‰çµæŸå¾Œçš„è™•ç† (6ç§’å¾Œ)
            setTimeout(() => {
                spinSound.pause();
                
                winSound.currentTime = 0;
                winSound.play().catch(e => console.error("ç„¡æ³•æ’­æ”¾çµæŸéŸ³æ•ˆ (win.mp3)ã€‚", e)); 
                
                resultDiv.innerHTML = `ğŸ‰ æ­å–œï¼æŠ½ä¸­äº†ï¼š<br><strong>${winningPrize}</strong>`;
                spinButton.disabled = false;
            }, 6000); 
        }, 10); // å»¶é² 10msï¼Œç¢ºä¿é‡ç½®ç”Ÿæ•ˆ
    }

    /**
     * é‡è¨­è½‰ç›¤ (ä¿æŒä¸è®Š)
     */
    function resetWheel() {
        spinSound.pause();
        
        wheel.style.transition = 'transform 0.5s ease-out'; 
        wheel.style.transform = 'rotate(0deg)';
        currentTotalRotation = 0; // é‡è¨­ç´¯ç©è§’åº¦
        
        resultDiv.textContent = 'é»æ“Šã€Œé–‹å§‹æŠ½ç±¤ã€ï¼Œæ±ºå®šæ‚¨çš„æ—…ç¨‹ï¼';
        spinButton.disabled = false;

        setTimeout(() => {
             wheel.style.transition = 'transform 6s cubic-bezier(0.25, 0.1, 0.25, 1)';
        }, 500);
    }

    // --- åˆå§‹åŒ–å’Œäº‹ä»¶ç›£è½ ---
    document.addEventListener('DOMContentLoaded', () => {
        createWheelSlices();
        spinButton.addEventListener('click', spinWheel);
        resetButton.addEventListener('click', resetWheel);
        
        spinSound.load();
        winSound.load();
    });

    </script>
</body>
</html>
